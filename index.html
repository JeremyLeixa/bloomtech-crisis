<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BloomTech Crisis Simulation | IDRAC Business School</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .hero-section {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9), rgba(118, 75, 162, 0.9)), 
                        linear-gradient(45deg, #ff6b6b, #ffd93d);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            max-width: 800px;
            z-index: 2;
            padding: 2rem;
        }

        .company-logo {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInUp 1s ease 0.5s forwards;
        }

        .crisis-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInUp 1s ease 1s forwards;
        }

        .crisis-subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            opacity: 0;
            animation: fadeInUp 1s ease 1.5s forwards;
        }

        .start-simulation {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            opacity: 0;
            animation: fadeInUp 1s ease 2s forwards;
        }

        .start-simulation:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .floating-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .phase-section {
            min-height: 100vh;
            padding: 4rem 2rem;
            display: none;
        }

        .phase-section.active {
            display: block;
        }

        .phase-header {
            text-align: center;
            margin-bottom: 3rem;
            color: white;
        }

        .phase-header h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .phase-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Phase 1 - Email Analysis */
        .email-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .email-inbox {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .email-item {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid #3b82f6;
            cursor: default;
            transition: all 0.3s ease;
            position: relative;
        }

        .email-item::before {
            content: "üìñ";
            position: absolute;
            top: 1rem;
            right: 1rem;
            opacity: 0.6;
            font-size: 0.9rem;
        }

        .email-item.priority-high {
            border-left-color: #dc2626;
            background: linear-gradient(135deg, #fef2f2, #fee2e2);
        }

        .email-item.priority-medium {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fffbeb, #fef3c7);
        }

        .email-header {
            display: flex;
            justify-content: between;
            align-items: flex-start;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .email-from {
            font-weight: 700;
            color: #1f2937;
        }

        .email-subject {
            font-weight: 600;
            color: #374151;
            flex: 1;
            min-width: 200px;
        }

        .email-time {
            font-size: 0.9rem;
            color: #6b7280;
            white-space: nowrap;
        }

        .email-priority {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .priority-urgent {
            background: #dc2626;
            color: white;
        }

        .priority-high {
            background: #f59e0b;
            color: white;
        }

        .priority-normal {
            background: #10b981;
            color: white;
        }

        .email-content {
            color: #4b5563;
            line-height: 1.6;
            margin-top: 1rem;
        }

        .email-easter-egg {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 6px;
            padding: 0.5rem;
            margin: 0.5rem 0;
            font-size: 0.9rem;
            color: #1e40af;
        }

        .analysis-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 16px;
            padding: 2rem;
            color: white;
            margin-top: 2rem;
            position: relative;
        }

        .progress-indicators-bottom {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            backdrop-filter: blur(10px);
        }

        .progress-item {
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .progress-item:last-child {
            margin-bottom: 0;
        }

        .progress-bar-container {
            width: 120px;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: #10b981;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-bar-fill.complete {
            background: #10b981;
        }

        .progress-bar-fill.partial {
            background: #f59e0b;
        }

        .easter-egg-counter {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            text-align: center;
        }

        .easter-egg-counter.visible {
            opacity: 1;
        }

        .micro-challenge {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.9rem;
            border-left: 3px solid #fbbf24;
        }

        .button-tooltip {
            position: relative;
        }

        .button-tooltip:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.8rem 1rem;
            border-radius: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
            z-index: 1000;
            max-width: 300px;
            white-space: normal;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .button-tooltip:hover::before {
            content: "";
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid rgba(0, 0, 0, 0.9);
            z-index: 1001;
        }

        .email-easter-egg {
            background: rgba(59, 130, 246, 0.1);
            border: 2px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 0.8rem;
            margin: 0.8rem 0;
            font-size: 0.9rem;
            color: #1e40af;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            user-select: none;
            font-weight: 500;
        }

        .email-easter-egg:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateX(3px) scale(1.02);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .email-easter-egg:hover::before {
            content: "üí° Click to discover clue";
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.5rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 1000;
            margin-bottom: 0.5rem;
            animation: tooltipFadeIn 0.2s ease;
        }

        .email-easter-egg.discovered {
            background: rgba(16, 185, 129, 0.15);
            border-color: rgba(16, 185, 129, 0.4);
            color: #065f46;
            cursor: default;
            transform: none;
            animation: easterEggFound 0.6s ease;
        }

        .email-easter-egg.discovered::after {
            content: " ‚úì Clue Discovered";
            font-weight: 700;
            color: #10b981;
        }

        .email-easter-egg.discovered:hover {
            transform: none;
            box-shadow: none;
        }

        .email-easter-egg.discovered:hover::before {
            display: none;
        }

        @keyframes tooltipFadeIn {
            from { opacity: 0; transform: translateX(-50%) translateY(5px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        @keyframes easterEggFound {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); background: rgba(16, 185, 129, 0.3); }
            100% { transform: scale(1); }
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .problem-selection {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .problem-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .problem-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .problem-checkbox {
            margin-top: 0.2rem;
        }

        .problem-description {
            flex: 1;
        }

        .justification-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .justification-textarea {
            width: 100%;
            min-height: 200px;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-family: inherit;
            resize: vertical;
            margin-top: 1rem;
        }

        .justification-textarea::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .validate-analysis {
            background: #10b981;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 2rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .validate-analysis:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .validate-analysis:disabled {
            background: #6b7280;
            cursor: not-allowed;
            transform: none;
        }

        /* Phase 2 - Team Selection */
        .teams-briefing {
            max-width: 1400px;
            margin: 0 auto;
        }

        .briefing-intro {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 3rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .team-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 2rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .team-card.crisis {
            border-image: linear-gradient(135deg, #10b981, #059669) 1;
            border-style: solid;
        }

        .team-card.legal {
            border-image: linear-gradient(135deg, #dc2626, #991b1b) 1;
            border-style: solid;
        }

        .team-card.media {
            border-image: linear-gradient(135deg, #3b82f6, #1d4ed8) 1;
            border-style: solid;
        }

        .team-card.influencer {
            border-image: linear-gradient(135deg, #ec4899, #be185d) 1;
            border-style: solid;
        }

        .team-card.strategy {
            border-image: linear-gradient(135deg, #667eea, #764ba2) 1;
            border-style: solid;
        }

        .team-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1.5rem;
            color: white;
        }

        .team-icon.crisis { background: linear-gradient(135deg, #10b981, #059669); }
        .team-icon.legal { background: linear-gradient(135deg, #dc2626, #991b1b); }
        .team-icon.media { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        .team-icon.influencer { background: linear-gradient(135deg, #ec4899, #be185d); }
        .team-icon.strategy { background: linear-gradient(135deg, #667eea, #764ba2); }

        .team-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .team-description {
            color: #4b5563;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .team-responsibilities {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .team-responsibilities h4 {
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            font-weight: 600;
        }

        .team-responsibilities ul {
            list-style: none;
            color: #6b7280;
            font-size: 0.9rem;
        }

        .team-responsibilities li {
            padding: 0.2rem 0;
            position: relative;
            padding-left: 1rem;
        }

        .team-responsibilities li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #3b82f6;
        }

        .join-team-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
        }

        .join-team-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .interdependency-diagram {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin: 3rem auto;
            max-width: 800px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .notification {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: #10b981;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        .validation-feedback {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            color: white;
            display: none;
        }

        .validation-feedback.show {
            display: block;
        }

        .validation-feedback.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .validation-feedback.partial {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        @media (max-width: 768px) {
            .analysis-grid {
                grid-template-columns: 1fr;
            }
            
            .teams-grid {
                grid-template-columns: 1fr;
            }
            
            .email-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero-section" id="heroSection">
        <div class="floating-particles">
            <div class="particle" style="width: 10px; height: 10px; left: 10%; animation-delay: 0s;"></div>
            <div class="particle" style="width: 15px; height: 15px; left: 20%; animation-delay: 1s;"></div>
            <div class="particle" style="width: 8px; height: 8px; left: 35%; animation-delay: 2s;"></div>
            <div class="particle" style="width: 12px; height: 12px; left: 50%; animation-delay: 1.5s;"></div>
            <div class="particle" style="width: 18px; height: 18px; left: 65%; animation-delay: 0.5s;"></div>
            <div class="particle" style="width: 14px; height: 14px; left: 80%; animation-delay: 2.5s;"></div>
            <div class="particle" style="width: 11px; height: 11px; left: 90%; animation-delay: 1.8s;"></div>
        </div>
        
        <div class="hero-content">
            <div class="company-logo">üå∏ BloomTech</div>
            <h1 class="crisis-title">CRISIS SIMULATION</h1>
            <p class="crisis-subtitle">
                Your marketing campaign just went viral... for all the wrong reasons.<br>
                Can your team save the company before it's too late?
            </p>
            <button class="start-simulation" onclick="startSimulation()">
                üöÄ Start Crisis Management Simulation
            </button>
        </div>
    </section>

    <!-- Phase 1: Email Analysis -->
    <section class="phase-section" id="phase1">
        <div class="phase-header">
            <h2>üìß Phase 1: Crisis Intelligence</h2>
            <p>Analyze the incoming communications to identify the real problems behind the chaos</p>
        </div>

        <div class="email-container">
            <div class="email-inbox" id="emailInbox">
                <!-- Emails will be dynamically loaded here -->
            </div>

            <div class="analysis-section">
                <h3>üéØ Crisis Analysis</h3>
                <p>From the emails above, identify the 4 REAL problems that require immediate action, then justify your analysis.</p>
                
                <div class="micro-challenge">
                    <strong>üí° Important:</strong> Analyze each email carefully for hidden details and connections. Teams will need specific information from these communications to succeed in Phase 2. Look for technical specifications, deadlines, contact information, financial data, and legal references.
                </div>
                
                <div class="analysis-grid">
                    <div class="problem-selection">
                        <h4>Select the 4 Real Problems:</h4>
                        <div id="problemsList">
                            <!-- Problems will be dynamically loaded -->
                        </div>
                    </div>
                    
                    <div class="justification-section">
                        <h4>Justify Your Analysis:</h4>
                        <p style="font-size: 0.9rem; opacity: 0.8; margin-bottom: 1rem;">
                            Explain why you selected these problems and why others are distractors.
                        </p>
                        <textarea 
                            class="justification-textarea" 
                            id="justificationText"
                            placeholder="Explain your reasoning:

‚Ä¢ Why are your selected problems the most critical?
‚Ä¢ What makes the other issues secondary or false alarms?
‚Ä¢ How do these problems connect to each other?
‚Ä¢ What would happen if these issues aren't addressed immediately?

Be specific and use evidence from the emails to support your analysis."
                        ></textarea>
                    </div>
                </div>

                <div class="progress-indicators-bottom">
                    <div class="progress-item">
                        <span><strong>Problems Selected:</strong></span>
                        <div class="progress-info">
                            <span id="problemsCount">0/4</span>
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" id="problemsProgress"></div>
                            </div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <span><strong>Analysis Length:</strong></span>
                        <div class="progress-info">
                            <span id="analysisCount">0/100</span>
                            <div class="progress-bar-container">
                                <div class="progress-bar-fill" id="analysisProgress"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="validate-analysis button-tooltip" id="validateBtn" onclick="validateAnalysis()" data-tooltip="Select 4 problems and write detailed analysis to proceed">
                    üéØ Submit Analysis & Proceed to Team Assignment
                </button>

                <div class="validation-feedback" id="validationFeedback">
                    <!-- Feedback will appear here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Phase 2: Team Selection -->
    <section class="phase-section" id="phase2">
        <div class="phase-header">
            <h2>üöÄ Phase 2: Crisis Response Teams</h2>
            <p>The situation is critical. Choose your specialized team and take immediate action.</p>
        </div>

        <div class="teams-briefing">
            <div class="briefing-intro">
                <h3>üéØ Mission Briefing</h3>
                <p>You've identified the crisis. Now it's time to act. Each team has specialized tools and responsibilities. Choose your role wisely - your decisions will impact the entire company.</p>
                <p><strong>‚ö†Ô∏è Important:</strong> Teams are interdependent. Success requires coordination and communication between all units.</p>
            </div>

            <div class="teams-grid">
                <div class="team-card crisis" onclick="joinTeam('crisis')">
                    <div class="team-icon crisis">üîç</div>
                    <div class="team-name">Crisis Analysis Team</div>
                    <div class="team-description">
                        Technical investigation unit responsible for identifying root causes and providing detailed analysis to all other teams.
                    </div>
                    <div class="team-responsibilities">
                        <h4>Key Responsibilities:</h4>
                        <ul>
                            <li>Analyze technical failures and system logs</li>
                            <li>Create detailed timeline of events</li>
                            <li>Provide technical data to Legal and Media teams</li>
                            <li>Assess ongoing technical risks</li>
                        </ul>
                    </div>
                    <button class="join-team-btn">Join Crisis Analysis</button>
                </div>

                <div class="team-card legal" onclick="joinTeam('legal')">
                    <div class="team-icon legal">‚öñÔ∏è</div>
                    <div class="team-name">Legal Response Team</div>
                    <div class="team-description">
                        Legal compliance specialists handling regulatory requirements and authorizing public communications.
                    </div>
                    <div class="team-responsibilities">
                        <h4>Key Responsibilities:</h4>
                        <ul>
                            <li>Respond to FTC compliance inquiry</li>
                            <li>Assess legal risks and liabilities</li>
                            <li>Approve Media team communications</li>
                            <li>Ensure regulatory compliance</li>
                        </ul>
                    </div>
                    <button class="join-team-btn">Join Legal Response</button>
                </div>

                <div class="team-card media" onclick="joinTeam('media')">
                    <div class="team-icon media">üì∞</div>
                    <div class="team-name">Media Response Team</div>
                    <div class="team-description">
                        Communications specialists managing public narrative and press relations during the crisis.
                    </div>
                    <div class="team-responsibilities">
                        <h4>Key Responsibilities:</h4>
                        <ul>
                            <li>Draft official press statements</li>
                            <li>Manage journalist inquiries</li>
                            <li>Coordinate with Legal for message approval</li>
                            <li>Control public narrative</li>
                        </ul>
                    </div>
                    <button class="join-team-btn">Join Media Response</button>
                </div>

                <div class="team-card influencer" onclick="joinTeam('influencer')">
                    <div class="team-icon influencer">üì±</div>
                    <div class="team-name">Influencer Relations Team</div>
                    <div class="team-description">
                        Relationship managers focused on containing influencer backlash and negotiating damage control.
                    </div>
                    <div class="team-responsibilities">
                        <h4>Key Responsibilities:</h4>
                        <ul>
                            <li>Negotiate with angry influencers</li>
                            <li>Manage compensation and partnerships</li>
                            <li>Prevent viral negative campaigns</li>
                            <li>Restore influencer relationships</li>
                        </ul>
                    </div>
                    <button class="join-team-btn">Join Influencer Relations</button>
                </div>

                <div class="team-card strategy" onclick="joinTeam('strategy')">
                    <div class="team-icon strategy">üëë</div>
                    <div class="team-name">Strategy Team</div>
                    <div class="team-description">
                        Executive coordinators with oversight of all teams, budget authority, and responsibility for overall crisis strategy.
                    </div>
                    <div class="team-responsibilities">
                        <h4>Key Responsibilities:</h4>
                        <ul>
                            <li>Coordinate all team activities</li>
                            <li>Approve budgets and major decisions</li>
                            <li>Monitor overall crisis progress</li>
                            <li>Present final action plan to board</li>
                        </ul>
                    </div>
                    <button class="join-team-btn">Join Strategy Team</button>
                </div>
            </div>

            <div class="interdependency-diagram">
                <h3>üîÑ Team Interdependencies</h3>
                <p><strong>Crisis Analysis</strong> provides data ‚Üí <strong>Legal</strong> assesses risks ‚Üí <strong>Media</strong> communicates</p>
                <p><strong>Strategy</strong> approves budgets ‚Üí <strong>Influencer Relations</strong> negotiates</p>
                <p><strong>All teams</strong> coordinate through <strong>Strategy</strong> for maximum impact</p>
            </div>
        </div>
    </section>

    <div class="notification" id="notification"></div>

    <script>
        // Email data with realistic business content and integrated intelligence
        const emails = [
            {
                id: 1,
                from: "James Morgan, CEO",
                subject: "Good Morning Team - #NaturalGlow Launch Day!",
                time: "08:15 AM",
                priority: "normal",
                className: "priority-normal",
                content: `Team,

Today's the big day! #NaturalGlow campaign goes live and Marketing estimates we'll hit 2M+ impressions in the first 24 hours.

Q3 numbers just came in - 47% growth in subscriber base, CAC down to $23, and retention holding steady at 89%. Board meeting next week is going to be a celebration.

Sarah, just a reminder that our compliance review deadline is Friday. With our "100% Natural" claims, we want to be bulletproof if FTC comes knocking.

Let's make this launch legendary!

James

P.S. - IT, thanks for the late-night system update. Hope everything deployed smoothly.`
            },
            {
                id: 2,
                from: "Alex Chen, IT Director",
                subject: "URGENT: Critical Campaign System Failure",
                time: "09:42 AM",
                priority: "urgent",
                className: "priority-high",
                content: `ALL TEAMS - CRITICAL ISSUE

Major system failure detected in our campaign management platform. The routine update that deployed at 03:47 AM has caused a catastrophic bug.

SITUATION: Our #NaturalGlow ads are displaying PureBeauty's slogans instead of ours across all platforms.

IMPACT ASSESSMENT:
- Instagram, Facebook, TikTok campaigns affected
- Estimated 500,000+ users exposed to competitor messaging
- Real-time analytics show "Glow Naturally with PureBeauty" appearing where our copy should be

I've initiated emergency shutdown protocols. Need immediate crisis response team activation.

This is not a drill. Our biggest campaign launch just became free advertising for our main competitor.

Alex Chen
IT Director
Emergency contact: alex.chen@bloomtech.com`
            },
            {
                id: 3,
                from: "Sarah Kim",
                subject: "RE: Partnership Violation - THIS IS UNACCEPTABLE",
                time: "10:15 AM",
                priority: "urgent",
                className: "priority-high",
                content: `BloomTech Team,

I cannot believe what I woke up to this morning. My DMs are EXPLODED with followers asking why I'm promoting PureBeauty when I have an EXCLUSIVE partnership with you.

My analytics dashboard shows my engagement rate skyrocketing - but for YOUR COMPETITOR. Do you understand how this destroys my credibility?

Facts you need to know:
- I have 2.1 million followers across platforms
- Our partnership rate is $15,000 per sponsored post
- I'm contractually bound to exclusivity until March 2025

I'm posting a clarification statement at NOON if I don't get answers and compensation. My audience deserves better than this amateur-hour mistake.

This better be fixed immediately.

Sarah Kim
@SarahGlowUp
Influencer & Brand Partner
Contact: sarah@sarahglowup.com`
            },
            {
                id: 4,
                from: "Michael Torres, Legal Counsel",
                subject: "FTC Compliance Inquiry - IMMEDIATE RESPONSE REQUIRED",
                time: "10:33 AM",
                priority: "urgent",
                className: "priority-high",
                content: `Legal Team & Senior Management,

Federal Trade Commission has initiated formal inquiry into BloomTech's marketing claims. This is not routine.

COMPLIANCE VIOLATIONS IDENTIFIED:
- Product batch BT-2024-Q3 contains synthetic compounds contradicting "100% Natural" claims
- Missing mandatory disclosures on influencer partnership agreements
- Misleading organic certification statements in advertising materials

LEGAL REQUIREMENTS:
- Response deadline: 5:00 PM TODAY
- Documentation package required for all affected batches
- Potential criminal penalties if willful misrepresentation is established

I need Strategy and Marketing to conference immediately. We're potentially looking at class-action exposure and regulatory sanctions.

This could shut down operations if not handled correctly.

Michael Torres, JD
Senior Legal Counsel
Direct line: 555-0198
mtorres@bloomtech-legal.com`
            },
            {
                id: 5,
                from: "Emma Rodriguez, Marketing Director", 
                subject: "Media Crisis - Multiple Outlets Investigating",
                time: "11:07 AM",
                priority: "urgent",
                className: "priority-high",
                content: `Crisis Communications Team,

Media shitstorm incoming. Multiple publications are pursuing negative coverage simultaneously.

ACTIVE INVESTIGATIONS:
- TechCrunch: Story titled "BloomTech's Epic Marketing Fail" scheduled for 1:00 PM publication
- Forbes: Deep-dive into greenwashing allegations, interviewing former employees
- Vogue Business: Influencer contract investigation, focusing on disclosure violations
- BuzzFeed: Viral article "Beauty Brand Accidentally Promotes Rival"

SOCIAL MEDIA STATUS:
- #BloomTechFail trending on Twitter
- Negative sentiment analysis: 73% across platforms
- Competitor brands already capitalizing with response campaigns

I need legal clearance for ALL public statements. Cannot issue any communications without compliance review given FTC situation.

Recommend immediate war room formation.

Emma Rodriguez
Marketing Director
Direct: 555-0187
erodriguez@bloomtech.com`
            },
            {
                id: 6,
                from: "Lisa Park, Customer Success Manager",
                subject: "Customer Support Queue Critical - Immediate Escalation",
                time: "11:28 AM",
                priority: "high",
                className: "priority-medium",
                content: `Support Team & Management,

Customer service infrastructure is overwhelmed. Current queue status requires immediate attention.

VOLUME METRICS:
- 847 tickets opened in past 90 minutes (normal daily average: 23)
- Subscription cancellation requests: +23% above baseline
- Average response time increased from 2 hours to 8+ hours

PRIMARY COMPLAINT CATEGORIES:
- Campaign confusion: "Why are you promoting PureBeauty?"
- Refund demands on recent orders (particularly batch BT-2024-Q3)
- Partnership authenticity questions regarding influencer relationships

Customer satisfaction score dropped from 4.7 to 3.2 overnight. Without official messaging guidelines, agents are providing inconsistent responses.

Immediate talking points needed from Marketing/Legal before we can effectively respond.

Lisa Park
Customer Success Manager
Internal ext: 4422`
            },
            {
                id: 7,
                from: "David Kim",
                subject: "Partnership Contract Violation - Immediate Resolution Required",
                time: "11:45 AM",
                priority: "high",
                className: "priority-medium",
                content: `BloomTech Partnership Team,

As exclusive brand partner with 890,000 followers across Instagram, TikTok, and YouTube, I'm deeply concerned about this morning's campaign disaster affecting my professional reputation.

CONTRACT DETAILS:
- 6-month exclusivity agreement signed December 2024
- Performance rate: $8,000 per sponsored post
- Content creation quota: 2 posts monthly, 4 stories weekly

BRAND DAMAGE ASSESSMENT:
- My audience questioning partnership authenticity
- Engagement metrics showing confusion about brand allegiance
- Potential violation of exclusivity clause due to apparent competitor promotion

RESOLUTION REQUIREMENTS:
1. Public statement clarifying my non-involvement in technical error
2. Compensation discussion for reputation management
3. Immediate strategy meeting regarding Q1 content calendar

If unresolved by end of business today, I'll be forced to terminate partnership and pursue public clarification independently.

David Kim
@BeautyGuruMike
Partnership Contact: david@beautygurumike.com
Management: contact@influencertalent.agency`
            },
            {
                id: 8,
                from: "Jennifer Walsh, Board Chair",
                subject: "Emergency Board Meeting - 2:00 PM Today",
                time: "12:15 PM", 
                priority: "urgent",
                className: "priority-high",
                content: `Board of Directors & Executive Team,

Emergency board session scheduled for 2:00 PM. Attendance mandatory.

AGENDA ITEMS:
- Crisis assessment and immediate response strategy
- Financial exposure analysis and insurance implications
- Leadership accountability and potential organizational changes
- Investor relations strategy given pre-market performance

MARKET IMPACT:
- Stock price down 12% in pre-market trading
- Major institutional investors requesting immediate briefings
- Competitor stocks rising on our misfortune

REQUIRED DELIVERABLES:
- Comprehensive incident timeline from IT
- Legal risk assessment with mitigation strategies
- Financial impact projections for Q4
- Recovery plan with realistic timelines

Board has full authority to implement immediate changes if situation assessment warrants.

We need solutions, not excuses.

Jennifer Walsh
Board Chair
Direct: 555-0199
jwalsh@bloomtech-board.com`
            }
        ];

        // Problem options for analysis
        const problemOptions = [
            
            {
                id: "influencer-crisis",
                text: "Major influencer backlash threatening viral negative campaign",
                isCorrect: true
            },
            {
                id: "ftc-investigation",
                text: "FTC compliance investigation with criminal penalty risk",
                isCorrect: true
            },
            
            {
                id: "customer-support",
                text: "Customer support queue overload (operational issue)",
                isCorrect: false
            },
            {
                id: "tech-bug",
                text: "Technical system bug displaying competitor slogans",
                isCorrect: true
            },
            {
                id: "stock-price",
                text: "Stock price decline (symptom, not root cause)",
                isCorrect: false
            },
            {
                id: "board-pressure",
                text: "Board emergency meeting (consequence, not core problem)",
                isCorrect: false
            },
            {
                id: "exclusivity-violation",
                text: "Individual influencer contract disputes (manageable)",
                isCorrect: false
            },
            {
                id: "media-pressure",
                text: "Imminent negative media coverage across major publications",
                isCorrect: true
            },
        ];

        let selectedProblems = [];
        let phase1Completed = false;

        // Initialize simulation
        function startSimulation() {
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('phase1').classList.add('active');
            loadEmails();
            loadProblems();
        }

        // Initialize simulation
        function startSimulation() {
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('phase1').classList.add('active');
            loadEmails();
            loadProblems();
            // Easter egg tracking will be setup by DOMContentLoaded
        }

        // Load emails into the inbox
        function loadEmails() {
            const inbox = document.getElementById('emailInbox');
            inbox.innerHTML = emails.map(email => `
                <div class="email-item ${email.className}">
                    <div class="email-header">
                        <div class="email-from">${email.from}</div>
                        <div class="email-subject">${email.subject}</div>
                        <div class="email-time">${email.time}</div>
                        <div class="email-priority priority-${email.priority}">${email.priority}</div>
                    </div>
                    <div class="email-content">${email.content}</div>
                </div>
            `).join('');
        }

        // Load problem options
        function loadProblems() {
            const problemsList = document.getElementById('problemsList');
            problemsList.innerHTML = problemOptions.map(problem => `
                <div class="problem-item" onclick="toggleProblem('${problem.id}')">
                    <input type="checkbox" class="problem-checkbox" id="checkbox-${problem.id}">
                    <div class="problem-description">${problem.text}</div>
                </div>
            `).join('');
        }

        // Toggle problem selection
        function toggleProblem(problemId) {
            const checkbox = document.getElementById(`checkbox-${problemId}`);
            const isChecked = !checkbox.checked;
            
            if (isChecked) {
                if (selectedProblems.length >= 4) {
                    showNotification("Maximum 4 problems can be selected");
                    return;
                }
                selectedProblems.push(problemId);
                checkbox.checked = true;
            } else {
                selectedProblems = selectedProblems.filter(id => id !== problemId);
                checkbox.checked = false;
            }
            
            updateValidateButton();
        }



        // Update validate button state
        function updateValidateButton() {
            const justificationText = document.getElementById('justificationText').value.trim();
            const validateBtn = document.getElementById('validateBtn');
            
            // Update progress indicators
            const problemsCount = document.getElementById('problemsCount');
            const problemsProgress = document.getElementById('problemsProgress');
            const analysisCount = document.getElementById('analysisCount');
            const analysisProgress = document.getElementById('analysisProgress');
            
            // Problems progress
            problemsCount.textContent = `${selectedProblems.length}/4`;
            const problemsPercent = (selectedProblems.length / 4) * 100;
            problemsProgress.style.width = `${problemsPercent}%`;
            problemsProgress.className = `progress-bar-fill ${problemsPercent === 100 ? 'complete' : 'partial'}`;
            
            // Analysis progress
            const analysisLength = justificationText.length;
            analysisCount.textContent = `${analysisLength}/100`;
            const analysisPercent = Math.min((analysisLength / 100) * 100, 100);
            analysisProgress.style.width = `${analysisPercent}%`;
            analysisProgress.className = `progress-bar-fill ${analysisPercent >= 100 ? 'complete' : 'partial'}`;
            
            // Button state
            if (selectedProblems.length === 4 && analysisLength >= 100) {
                validateBtn.disabled = false;
                validateBtn.setAttribute('data-tooltip', 'Analysis complete! Click to proceed to team selection');
            } else {
                validateBtn.disabled = true;
                if (selectedProblems.length < 4) {
                    validateBtn.setAttribute('data-tooltip', `Select ${4 - selectedProblems.length} more problem(s)`);
                } else if (analysisLength < 100) {
                    validateBtn.setAttribute('data-tooltip', `Write ${100 - analysisLength} more characters in your analysis`);
                }
            }
        }
function setupAutoSave() {
    setInterval(() => {
        if (phase1Completed) return;
        const justification = document.getElementById('justificationText')?.value || '';
        if (justification.length > 50 || selectedProblems.length > 0) {
            localStorage.setItem('crisis_analysis_draft', JSON.stringify({
                selectedProblems: [...selectedProblems],
                justification,
                timestamp: new Date().toISOString()
            }));
        }
    }, 30000);
}
        // Enhanced event listeners with robust error handling
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing BloomTech Crisis Simulation...');
            
            try {
                // Setup textarea listeners with multiple event types
                const justificationTextarea = document.getElementById('justificationText');
                if (justificationTextarea) {
                    ['input', 'keyup', 'paste', 'change'].forEach(eventType => {
                        justificationTextarea.addEventListener(eventType, () => {
                            setTimeout(updateValidateButton, eventType === 'paste' ? 100 : 0);
                        });
                    });
                    console.log('‚úÖ Textarea listeners attached');
                } else {
                    console.warn('‚ö†Ô∏è Justification textarea not found');
                }
                
                // Initialize progress indicators
                setTimeout(() => {
                    updateValidateButton();
                    console.log('‚úÖ Progress indicators initialized');
                }, 200);
                
                // Setup easter egg tracking
                //setupEasterEggTracking();
                
                // Setup auto-save
                setupAutoSave();
                
                // Load any saved draft
                //setTimeout(loadSavedDraft, 500);
                
                console.log('üéâ Simulation initialized successfully');
                
           } catch (error) {
                console.error('‚ùå Initialization error:', error);
                showNotification('System initialization error - please refresh the page', 'error');
            }
        });

        // Auto-save functionality
        setInterval(() => {
            if (phase1Completed) return;
            
            const justification = document.getElementById('justificationText')?.value;
            if (justification && justification.length > 50) {
                localStorage.setItem('crisis_analysis_draft', JSON.stringify({
                    selectedProblems,
                    justification,
                    timestamp: new Date().toISOString()
                }));
            }
        }, 30000);

        // Load saved draft on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedDraft = localStorage.getItem('crisis_analysis_draft');
            if (savedDraft) {
                try {
                    const draft = JSON.parse(savedDraft);
                    if (draft.justification) {
                        document.getElementById('justificationText').value = draft.justification;
                    }
                    if (draft.selectedProblems) {
                        draft.selectedProblems.forEach(problemId => {
                            const checkbox = document.getElementById(`checkbox-${problemId}`);
                            if (checkbox) {
                                checkbox.checked = true;
                                selectedProblems.push(problemId);
                            }
                        });
                    }
                    updateValidateButton();
                } catch (e) {
                    console.log('Error loading draft:', e);
                }
            }
        });

        // Validate analysis
        function validateAnalysis() {
            const correctProblems = problemOptions.filter(p => p.isCorrect).map(p => p.id);
            const correctlySelected = selectedProblems.filter(id => correctProblems.includes(id));
            const incorrectlySelected = selectedProblems.filter(id => !correctProblems.includes(id));
            
            const score = correctlySelected.length;
            const justification = document.getElementById('justificationText').value;
            
            // Save analysis results
            localStorage.setItem('crisis_analysis_complete', 'true');
            localStorage.setItem('crisis_analysis_score', score);
            localStorage.setItem('crisis_analysis_justification', justification);
            
            // Show feedback
            const feedback = document.getElementById('validationFeedback');
            
            if (score === 4) {
                feedback.className = 'validation-feedback success show';
                feedback.innerHTML = `
                    <h4>üéØ Excellent Analysis! (${score}/4)</h4>
                    <p>You've correctly identified all critical issues requiring immediate action. Your team is ready to proceed to specialized crisis response.</p>
                    <p><strong>Next Step:</strong> Choose your specialized team below.</p>
                `;
                setTimeout(() => {
                    document.getElementById('phase1').classList.remove('active');
                    document.getElementById('phase2').classList.add('active');
                }, 3000);
            } else {
                feedback.className = 'validation-feedback partial show';
                feedback.innerHTML = `
                    <h4>‚ö†Ô∏è Partial Analysis (${score}/4)</h4>
                    <p>You identified ${score} out of 4 critical issues. In a real crisis, this could lead to missed priorities.</p>
                    <p><strong>Missed critical issues:</strong> ${correctProblems.filter(id => !selectedProblems.includes(id)).map(id => 
                        problemOptions.find(p => p.id === id).text
                    ).join(', ')}</p>
                    <p>Proceeding to team assignment, but consider how incomplete analysis affects decision-making...</p>
                `;
                setTimeout(() => {
                    document.getElementById('phase1').classList.remove('active');
                    document.getElementById('phase2').classList.add('active');
                }, 5000);
            }
            
            phase1Completed = true;
        }

        // Join team function
        function joinTeam(teamType) {
            const teamUrls = {
                crisis: 'teams/crisis-analysis.html',
                legal: 'teams/legal.html',
                media: 'teams/media-response.html',
                influencer: 'teams/influencer-relations.html',
                strategy: 'teams/strategy.html'
            };
            
            // Save team selection
            localStorage.setItem('selected_team', teamType);
            localStorage.setItem('phase1_completed', 'true');
            
            // Redirect to team interface
            window.location.href = teamUrls[teamType];
        }

        // Notification system
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Auto-save functionality
        setInterval(() => {
            if (phase1Completed) return;
            
            const justification = document.getElementById('justificationText')?.value;
            if (justification && justification.length > 50) {
                localStorage.setItem('crisis_analysis_draft', JSON.stringify({
                    selectedProblems,
                    justification,
                    timestamp: new Date().toISOString()
                }));
            }
        }, 30000);

        // Load saved draft on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedDraft = localStorage.getItem('crisis_analysis_draft');
            if (savedDraft) {
                try {
                    const draft = JSON.parse(savedDraft);
                    if (draft.justification) {
                        document.getElementById('justificationText').value = draft.justification;
                    }
                    if (draft.selectedProblems) {
                        draft.selectedProblems.forEach(problemId => {
                            const checkbox = document.getElementById(`checkbox-${problemId}`);
                            if (checkbox) {
                                checkbox.checked = true;
                                selectedProblems.push(problemId);
                            }
                        });
                    }
                    updateValidateButton();
                } catch (e) {
                    console.log('Error loading draft:', e);
                }
            }
        });
    </script>
</body>
</html>
